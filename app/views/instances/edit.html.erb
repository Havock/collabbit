<% content_for :title, title('Edit') %>

<% content_for :subheader_title, "Account Settings" %>

<% content_for :body do%>	
	<%= error_messages_for :instance %>
	<% form_for @instance, :url => {:action => :update} do |f| -%>
		<p><%= f.label :long_name, 'Name' %><br/>
		<%= f.text_field :long_name %></p>
		
		<p><%= f.label :whitelisted_domain_names, 'Whitelisted Domains' %><br/>
		<%= f.text_area :whitelisted_domain_names, :rows => 5, :cols => 30 %></p>
	
		<table id="permissions" cellspacing="0">
			<thead>
				<tr>
					<th colspan="2">Permissions</th>
					<% @roles.each do |r| %>
						<th><%= r.name %></th>
					<% end %>
				</tr>
			</thead>
			<tbody>
				<% @perms_hash.each_pair do |model, actions| %> 
					<tr>
						<td class="model" rowspan="<%= actions.length %>"><%= model.pluralize %></td>
					<% actions.each do |action| %>
						<td class="action"><%= action %></td> 
						<% @roles.each do |role| %>
							<td class="cb">
								<%= permission_checkbox role, action, model.classify.gsub(/ /,'') %>
							</td>
						<% end %>
						</tr>
						<!-- %= '<tr>' unless actions.last == action % -->
					<% end %>	
					<td class="skip" colspan="<%= @roles.size + 2 %>"</tr>
				<% end %> 
			</tbody>
		</table>
	
		<p><%= submit_tag 'Save' %></p>
	<% end -%>
<% end %>
